<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Profile</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="../Header/header.css">
    <link rel="stylesheet" href="../Footer/footer.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#36C2CE',
            secondary: '#0ea5e9',
            accent: '#10b981',
            dark: '#1e293b',
          },
        },
      },
    };
  </script>
<style>
  /* Hide footer only on mobile & tablet (â‰¤1024px) */
  @media (max-width: 1024px) {
    #footer-placeholder {
      display: none !important;
    }
  }
</style>
  

</head>
<body class="bg-cover bg-center bg-no-repeat min-h-screen flex flex-col"
      style="background-image: url('https://i.pinimg.com/736x/1e/e5/07/1ee5072a72ffa83aace4863dd6bd23cd.jpg');">

  <!-- Header Placeholder -->
  <div id="header-placeholder"></div>

  <!-- Centered Main Container -->
  <div class="flex-grow flex items-center justify-center py-10 mt-32">
    <div class="w-full max-w-6xl bg-white shadow-md rounded-lg flex flex-col md:flex-row overflow-hidden">

      <!-- Sidebar -->
      <div class="w-full md:w-1/3 bg-primary/10 border-r border-primary p-6 flex flex-col items-center">
        <div class="w-24 h-24 bg-primary text-white rounded-full flex items-center justify-center text-5xl mb-4">
          <i class="fa-regular fa-user"></i>
        </div>
        <h2 class="text-xl font-bold text-dark mb-1" id="profileName">Loading...</h2>
        <p class="text-sm text-gray-600 mb-6">Member</p>

        <nav class="w-full">
          <button id="profileTab" class="w-full text-left flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-white mb-2">
            <i class="fa-solid fa-user"></i> Profile Information
          </button>
          <button id="addressTab" class="w-full text-left flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-primary/20">
            <i class="fa-solid fa-location-dot"></i> Addresses
          </button>
        </nav>
      </div>

      <!-- Right Section -->
      <div class="w-full md:w-3/3 p-6">
        <!-- Profile Info -->
        <div id="profileInfo">
          <div class="flex justify-between items-center mb-4 ">
            <h2 class="text-2xl font-bold text-dark">Personal Information</h2>
            <button id="editBtn" class="bg-primary text-white px-4 py-2 rounded-md hover:bg-secondary transition">
              Edit Profile
            </button>
          </div>

          <div class="flex items-center gap-4 mb-6">
            <div class="w-16 h-16 bg-primary/20 text-primary rounded-full flex items-center justify-center text-3xl font-bold">
              <i class="fa-regular fa-user"></i>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-dark" id="displayName">Loading...</h3>
              <p class="text-sm text-gray-500">Member since 2024</p>
            </div>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700">First Name *</label>
              <input id="firstName" type="text" 
                class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary focus:ring-primary outline-none" disabled />
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700">Last Name *</label>
              <input id="lastName" type="text" 
                class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary focus:ring-primary outline-none" disabled />
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700">Phone Number *</label>
              <input id="phoneNumber" type="text" 
                class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary focus:ring-primary outline-none" disabled />
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700">Email Address *</label>
              <input id="emailAddress" type="email" 
                class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary focus:ring-primary outline-none" disabled />
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700">Account Status</label>
              <input id="accountStatus" type="text" value="Active"
                class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary focus:ring-primary outline-none" disabled />
            </div>
          </div>

          <div class="mt-6">
            <button id="changePasswordBtn" class="bg-dark text-white px-4 py-2 rounded-md hover:bg-primary transition">
              Change Password
            </button>
            <button id="deleteAccountBtn" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition ml-4">
              Delete Account
            </button>
          </div>
        </div>

        <!-- Addresses -->
        <div id="addressInfo" class="hidden">
          <div class="flex justify-between items-center mb-4 ">
            <h2 class="text-2xl font-bold text-dark">Saved Addresses</h2>
            <button id="addAddressBtn" class="bg-primary text-white px-4 py-2 rounded-md hover:bg-secondary transition">
              <i class="fa-solid fa-plus mr-2"></i> Add New Address
            </button>
          </div>

          <div id="addressList" class="space-y-4">
            <p class="text-gray-600" id="noAddressMsg">Loading addresses...</p>
          </div>
        </div>
      </div>
    </div>
  </div>

 <!-- Change Password Modal -->
<div id="passwordModal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-lg w-11/12 max-w-md p-6 max-h-[80vh] overflow-y-auto scrollbar-thin scrollbar-thumb-primary scrollbar-track-gray-100">
    <h3 class="text-xl font-semibold text-dark mb-4">Change Password</h3>
    <label class="block text-sm font-medium text-gray-700 mb-1">Current Password</label>
    <input type="password" id="currentPass" class="w-full border border-gray-300 rounded-md px-3 py-2 mb-3 focus:border-primary outline-none">
    <label class="block text-sm font-medium text-gray-700 mb-1">New Password</label>
    <input type="password" id="newPass" class="w-full border border-gray-300 rounded-md px-3 py-2 mb-3 focus:border-primary outline-none">
    <label class="block text-sm font-medium text-gray-700 mb-1">Confirm Password</label>
    <input type="password" id="confirmPass" class="w-full border border-gray-300 rounded-md px-3 py-2 mb-5 focus:border-primary outline-none">
    <div class="flex justify-end gap-3">
      <button id="cancelPassBtn" class="bg-gray-300 text-dark px-4 py-2 rounded-md hover:bg-gray-400">Cancel</button>
      <button id="savePassBtn" class="bg-primary text-white px-4 py-2 rounded-md hover:bg-secondary">Save</button>
    </div>
  </div>
</div>

<!-- Address Modal -->
<div id="addressModal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-lg w-11/12 max-w-lg p-6 max-h-[50vh] overflow-y-auto scrollbar-thin scrollbar-thumb-primary scrollbar-track-gray-100">
    <h3 class="text-xl font-semibold text-dark mb-4" id="addressModalTitle">Add New Address</h3>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700">First Name *</label>
        <input id="addressFirstName" type="text" class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary outline-none" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Last Name *</label>
        <input id="addressLastName" type="text" class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary outline-none" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Phone Number *</label>
        <input id="addressPhone" type="text" class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary outline-none" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Email Address *</label>
        <input id="addressEmail" type="email" class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary outline-none" />
      </div>
      <div class="col-span-2">
        <label class="block text-sm font-medium text-gray-700">Address Landmark *</label>
        <input id="addressLandmark" type="text" class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary outline-none" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Address Area *</label>
        <input id="addressArea" type="text" class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary outline-none" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">City *</label>
        <input id="addressCity" type="text" class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary outline-none" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Pincode *</label>
        <input id="addressPincode" type="text" class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary outline-none" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">State *</label>
        <input id="addressState" type="text" class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary outline-none" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Country *</label>
        <input id="addressCountry" type="text" class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary outline-none" />
      </div>
      <div class="col-span-2">
        <label class="block text-sm font-medium text-gray-700">Address Type *</label>
        <select id="addressType" class="mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:border-primary outline-none">
          <option value="HOME">HOME</option>
          <option value="WORK">WORK</option>
          <option value="OTHER">OTHER</option>
        </select>
      </div>
    </div>
    <div class="flex justify-end gap-3 mt-5">
      <button id="cancelAddressBtn" class="bg-gray-300 text-dark px-4 py-2 rounded-md hover:bg-gray-400">Cancel</button>
      <button id="saveAddressBtn" class="bg-primary text-white px-4 py-2 rounded-md hover:bg-secondary">Save</button>
    </div>
  </div>
</div>

<!-- Placeholder for Footer -->
  <div id="footer-placeholder"></div>
  

    

    <script>
    function loadHeader() {
        fetch('../Header/header.html')
            .then(r => { if (!r.ok) throw r; return r.text(); })
            .then(html => {
                document.getElementById('header-placeholder').innerHTML = html;
                const script = document.createElement('script');
                script.src = '../Header/header.js';
                script.onload = () => console.log('Header JS loaded');
                document.body.appendChild(script);
            })
            .catch(err => console.error('Header load failed:', err));
    }

    function loadFooter() {
        fetch('../Footer/footer.html')
            .then(r => { if (!r.ok) throw r; return r.text(); })
            .then(html => {
                document.getElementById('footer-placeholder').innerHTML = html;
            })
            .catch(err => console.error('Footer load failed:', err));
    }

    document.addEventListener('DOMContentLoaded', () => {
        loadHeader();
        loadFooter();
        // ... rest of your code
    });
</script>
  <!-- JavaScript -->
  <script>
    // API Base URL
    const API_BASE_URL = 'http://localhost:8083/api/users';
    
    // Global variables
    let currentUserId = null;
    let currentUserData = null;
    let editingAddress = null;
    let isEditingProfile = false;

    // DOM Elements
    const profileTab = document.getElementById("profileTab");
    const addressTab = document.getElementById("addressTab");
    const profileInfo = document.getElementById("profileInfo");
    const addressInfo = document.getElementById("addressInfo");
    const editBtn = document.getElementById("editBtn");
    const inputs = document.querySelectorAll("#profileInfo input");
    const passwordModal = document.getElementById("passwordModal");
    const addressModal = document.getElementById("addressModal");
    const noAddressMsg = document.getElementById("noAddressMsg");
    const addressList = document.getElementById("addressList");
    const deleteAccountBtn = document.getElementById("deleteAccountBtn");

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
      // Get the logged-in user ID from session storage or local storage
      getCurrentUser();
    });

    // Get current user from storage or API
    async function getCurrentUser() {
      try {
        // Method 1: Check sessionStorage for logged-in user
        const storedUserId = sessionStorage.getItem('userId');
        const storedUserEmail = sessionStorage.getItem('userEmail');
        
        if (storedUserId) {
          currentUserId = parseInt(storedUserId);
          console.log('User ID from session:', currentUserId);
          loadUserData();
          setupEventListeners();
          return;
        }
        
        // Method 2: If you have the email, fetch user by email
        if (storedUserEmail) {
          const response = await fetch(`${API_BASE_URL}/get-by-user-email/${storedUserEmail}`);
          if (response.ok) {
            const userData = await response.json();
            currentUserId = userData.userId;
            sessionStorage.setItem('userId', currentUserId);
            loadUserData();
            setupEventListeners();
            return;
          }
        }
        
        // Method 3: Try to get current user from a session endpoint (if available)
        try {
          const sessionResponse = await fetch(`${API_BASE_URL}/current-user`, {
            credentials: 'include' // Include cookies
          });
          
          if (sessionResponse.ok) {
            const userData = await sessionResponse.json();
            currentUserId = userData.userId;
            sessionStorage.setItem('userId', currentUserId);
            loadUserData();
            setupEventListeners();
            return;
          }
        } catch (e) {
          console.log('No current-user endpoint available');
        }
        
        // If no user is found, redirect to login
        console.error('No logged-in user found');
        alert('Please log in to view your profile');
        window.location.href = '../index.html'; // Adjust path as needed
        
      } catch (error) {
        console.error('Error getting current user:', error);
        alert('Unable to verify login status. Please log in again.');
        window.location.href = '../index.html';
      }
    }

    // Setup all event listeners
    function setupEventListeners() {
      // Tab switching
      profileTab.onclick = () => {
        profileInfo.classList.remove("hidden");
        addressInfo.classList.add("hidden");
        profileTab.classList.add("bg-primary", "text-white");
        addressTab.classList.remove("bg-primary", "text-white");
      };

      addressTab.onclick = () => {
        addressInfo.classList.remove("hidden");
        profileInfo.classList.add("hidden");
        addressTab.classList.add("bg-primary", "text-white");
        profileTab.classList.remove("bg-primary", "text-white");
      };

      // Edit Profile
      editBtn.onclick = toggleEditProfile;

      // Change Password Modal
      document.getElementById("changePasswordBtn").onclick = () => passwordModal.classList.remove("hidden");
      document.getElementById("cancelPassBtn").onclick = () => passwordModal.classList.add("hidden");
      document.getElementById("savePassBtn").onclick = handlePasswordChange;

      // Address Modal
      document.getElementById("addAddressBtn").onclick = () => {
        editingAddress = null;
        document.getElementById("addressModalTitle").textContent = "Add New Address";
        clearAddressFields();
        addressModal.classList.remove("hidden");
      };

      document.getElementById("cancelAddressBtn").onclick = () => {
        addressModal.classList.add("hidden");
      };

      document.getElementById("saveAddressBtn").onclick = handleSaveAddress;

      // Delete Account
      deleteAccountBtn.onclick = handleDeleteAccount;
    }

    // Load user data from API
    async function loadUserData() {
      if (!currentUserId) {
        console.error('No user ID available');
        return;
      }
      
      try {
        const response = await fetch(`${API_BASE_URL}/get-by-user-id/${currentUserId}`);
        if (!response.ok) {
          if (response.status === 404) {
            throw new Error('User not found');
          }
          throw new Error('Failed to fetch user data');
        }
        
        const userData = await response.json();
        currentUserData = userData;
        
        // Update UI with user data
        updateProfileUI(userData);
        
        // Load addresses
        loadAddresses(userData);
      } catch (error) {
        console.error('Error loading user data:', error);
        alert('Failed to load user data: ' + error.message);
        // Optionally redirect to login
        // window.location.href = '/login.html';
      }
    }

    // Update profile UI with user data
    function updateProfileUI(userData) {
      document.getElementById("profileName").textContent = `${userData.firstName} ${userData.lastName}`;
      document.getElementById("displayName").textContent = `${userData.firstName} ${userData.lastName}`;
      document.getElementById("firstName").value = userData.firstName;
      document.getElementById("lastName").value = userData.lastName;
      document.getElementById("phoneNumber").value = userData.phone;
      document.getElementById("emailAddress").value = userData.email;
    }

    // Load addresses from user data
    function loadAddresses(userData) {
      // Clear existing addresses
      addressList.innerHTML = '';
      
      // Check if we have address data
      if (userData.addressLandmark) {
        noAddressMsg.classList.add("hidden");
        
        const addressDiv = document.createElement("div");
        addressDiv.className = "border border-gray-300 rounded-md p-4 flex justify-between items-start";
        addressDiv.innerHTML = `
          <div>
            <p class="font-semibold addr-name">${userData.firstName} ${userData.lastName}</p>
            <p class="text-gray-600 addr-line">${userData.addressLandmark}, ${userData.addressArea}, ${userData.addressCity} - ${userData.addressPincode}</p>
            <p class="text-gray-600 addr-phone">ðŸ“ž ${userData.phone}</p>
            <p class="text-gray-500 addr-type">${userData.addressType} Address</p>
          </div>
          <div>
            <button class="editAddressBtn bg-primary text-white px-3 py-1 rounded-md hover:bg-secondary transition mr-2">Edit</button>
            <button class="deleteAddressBtn bg-red-600 text-white px-3 py-1 rounded-md hover:bg-red-700 transition">Delete</button>
          </div>
        `;
        addressList.appendChild(addressDiv);

        // Set up event listeners for the buttons
        addressDiv.querySelector(".editAddressBtn").onclick = () => editAddress(userData);
        addressDiv.querySelector(".deleteAddressBtn").onclick = () => deleteAddress();
      } else {
        noAddressMsg.textContent = "You currently have no saved addresses.";
        noAddressMsg.classList.remove("hidden");
      }
    }

    // Toggle edit profile mode
    function toggleEditProfile() {
      isEditingProfile = !isEditingProfile;
      
      if (isEditingProfile) {
        editBtn.textContent = "Save Profile";
        inputs.forEach(i => i.disabled = false);
      } else {
        // Save the changes
        saveProfileChanges();
        editBtn.textContent = "Edit Profile";
        inputs.forEach(i => i.disabled = true);
      }
    }

    // Save profile changes to API
    async function saveProfileChanges() {
      try {
        const updatedData = {
          firstName: document.getElementById("firstName").value,
          lastName: document.getElementById("lastName").value,
          email: document.getElementById("emailAddress").value,
          phone: document.getElementById("phoneNumber").value,
          addressLandmark: currentUserData.addressLandmark,
          addressArea: currentUserData.addressArea,
          addressCity: currentUserData.addressCity,
          addressPincode: currentUserData.addressPincode,
          addressState: currentUserData.addressState,
          addressCountry: currentUserData.addressCountry,
          addressType: currentUserData.addressType
        };

        const response = await fetch(`${API_BASE_URL}/patch-user-by-id/${currentUserId}`, {
          method: 'PATCH',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(updatedData)
        });

        if (!response.ok) {
          throw new Error('Failed to update user data');
        }

        const updatedUser = await response.json();
        currentUserData = updatedUser;
        
        // Update UI
        updateProfileUI(updatedUser);
        
        alert("Profile updated successfully!");
      } catch (error) {
        console.error('Error updating profile:', error);
        alert('Failed to update profile. Please try again.');
      }
    }

    // Handle password change
    async function handlePasswordChange() {
      const currentPass = document.getElementById("currentPass").value;
      const newPass = document.getElementById("newPass").value;
      const confirmPass = document.getElementById("confirmPass").value;

      if (newPass !== confirmPass) {
        alert("New passwords do not match!");
        return;
      }

      if (newPass.trim() === "") {
        alert("Password cannot be empty!");
        return;
      }

      try {
        const updatedData = {
          ...currentUserData,
          password: newPass
        };

        const response = await fetch(`${API_BASE_URL}/patch-user-by-id/${currentUserId}`, {
          method: 'PATCH',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(updatedData)
        });

        if (!response.ok) {
          throw new Error('Failed to update password');
        }

        alert("Password changed successfully!");
        passwordModal.classList.add("hidden");
        
        // Clear password fields
        document.getElementById("currentPass").value = "";
        document.getElementById("newPass").value = "";
        document.getElementById("confirmPass").value = "";
      } catch (error) {
        console.error('Error changing password:', error);
        alert('Failed to change password. Please try again.');
      }
    }

    // Handle saving address (create or update)
    async function handleSaveAddress() {
      const addressData = {
        firstName: document.getElementById("addressFirstName").value,
        lastName: document.getElementById("addressLastName").value,
        email: document.getElementById("addressEmail").value,
        phone: document.getElementById("addressPhone").value,
        addressLandmark: document.getElementById("addressLandmark").value,
        addressArea: document.getElementById("addressArea").value,
        addressCity: document.getElementById("addressCity").value,
        addressPincode: document.getElementById("addressPincode").value,
        addressState: document.getElementById("addressState").value,
        addressCountry: document.getElementById("addressCountry").value,
        addressType: document.getElementById("addressType").value
      };

      // Validate required fields
      for (const [key, value] of Object.entries(addressData)) {
        if (!value.trim()) {
          alert(`Please fill in the ${key} field!`);
          return;
        }
      }

      try {
        const updatedUserData = {
          ...currentUserData,
          ...addressData
        };

        const response = await fetch(`${API_BASE_URL}/patch-user-by-id/${currentUserId}`, {
          method: 'PATCH',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(updatedUserData)
        });

        if (!response.ok) {
          throw new Error('Failed to save address');
        }

        const updatedUser = await response.json();
        currentUserData = updatedUser;
        
        // Update UI
        loadAddresses(updatedUser);
        
        addressModal.classList.add("hidden");
        alert("Address saved successfully!");
      } catch (error) {
        console.error('Error saving address:', error);
        alert('Failed to save address. Please try again.');
      }
    }

    // Edit address
    function editAddress(userData) {
      editingAddress = userData;
      document.getElementById("addressModalTitle").textContent = "Edit Address";
      
      // Fill the form with current address data
      document.getElementById("addressFirstName").value = userData.firstName;
      document.getElementById("addressLastName").value = userData.lastName;
      document.getElementById("addressEmail").value = userData.email;
      document.getElementById("addressPhone").value = userData.phone;
      document.getElementById("addressLandmark").value = userData.addressLandmark;
      document.getElementById("addressArea").value = userData.addressArea;
      document.getElementById("addressCity").value = userData.addressCity;
      document.getElementById("addressPincode").value = userData.addressPincode;
      document.getElementById("addressState").value = userData.addressState;
      document.getElementById("addressCountry").value = userData.addressCountry;
      document.getElementById("addressType").value = userData.addressType;
      
      addressModal.classList.remove("hidden");
    }

    // Delete address
    async function deleteAddress() {
      if (!confirm("Are you sure you want to delete this address?")) {
        return;
      }

      try {
        const updatedData = {
          ...currentUserData,
          addressLandmark: "",
          addressArea: "",
          addressCity: "",
          addressPincode: "",
          addressState: "",
          addressCountry: "",
          addressType: ""
        };

        const response = await fetch(`${API_BASE_URL}/patch-user-by-id/${currentUserId}`, {
          method: 'PATCH',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(updatedData)
        });

        if (!response.ok) {
          throw new Error('Failed to delete address');
        }

        const updatedUser = await response.json();
        currentUserData = updatedUser;
        
        // Update UI
        loadAddresses(updatedUser);
        
        alert("Address deleted successfully!");
      } catch (error) {
        console.error('Error deleting address:', error);
        alert('Failed to delete address. Please try again.');
      }
    }

    // Handle account deletion
    async function handleDeleteAccount() {
      if (!confirm("Are you sure you want to delete your account? This action cannot be undone.")) {
        return;
      }

      try {
        const response = await fetch(`${API_BASE_URL}/delete-by-user-id/${currentUserId}`, {
          method: 'DELETE'
        });

        if (!response.ok) {
          throw new Error('Failed to delete account');
        }

        const result = await response.text();
        alert(result);
        
        // Clear session storage
        sessionStorage.clear();
        
        // Redirect to home page or login page after deletion
        window.location.href = '/';
      } catch (error) {
        console.error('Error deleting account:', error);
        alert('Failed to delete account. Please try again.');
      }
    }

    // Clear address form fields
    function clearAddressFields() {
      const fields = [
        "addressFirstName", "addressLastName", "addressEmail", "addressPhone",
        "addressLandmark", "addressArea", "addressCity", "addressPincode",
        "addressState", "addressCountry"
      ];
      
      fields.forEach(id => {
        document.getElementById(id).value = "";
      });
      
      document.getElementById("addressType").value = "HOME";
    }
  </script>

  

  
</body>
</html>